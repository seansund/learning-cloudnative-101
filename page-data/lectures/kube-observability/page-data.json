{"componentChunkName":"component---src-pages-lectures-kube-observability-index-mdx","path":"/lectures/kube-observability/","result":{"pageContext":{"frontmatter":{"title":"Observability","description":"Observability in Kubernetes"},"relativePagePath":"/lectures/kube-observability/index.mdx","titleType":"page","MdxNode":{"id":"3c5fecca-0020-5f91-b5e2-7889bc8d4c6a","children":[],"parent":"b75c085f-66d6-5d0f-845e-021ba479bef4","internal":{"content":"---\ntitle: Observability\ndescription:  Observability in Kubernetes\n---\n\n<AnchorLinks small>\n  <AnchorLink>Liveness and Readiness Probes</AnchorLink>\n  <AnchorLink>Container Logging</AnchorLink>\n  <AnchorLink>Monitoring Applications</AnchorLink>\n  <AnchorLink>Activities</AnchorLink>\n</AnchorLinks>\n\n# Liveness and Readiness Probes\n\nA Probe is a diagnostic performed periodically by the kubelet on a Container. To perform a diagnostic, the kubelet calls a Handler implemented by the Container. There are three types of handlers:\n\n***ExecAction***: Executes a specified command inside the Container. The diagnostic is considered successful if the command exits with a status code of 0.\n\n***TCPSocketAction***: Performs a TCP check against the Container’s IP address on a specified port. The diagnostic is considered successful if the port is open.\n\n***HTTPGetAction***: Performs an HTTP Get request against the Container’s IP address on a specified port and path. The diagnostic is considered successful if the response has a status code greater than or equal to 200 and less than 400.\n\nThe kubelet can optionally perform and react to three kinds of probes on running Containers:\n\n***livenessProbe***: Indicates whether the Container is running. Runs for the lifetime of the Container.\n\n***readinessProbe***: Indicates whether the Container is ready to service requests. Only runs at start.\n\n\n## Resources\n\n**OpenShift**\n- [Application Health](https://docs.openshift.com/container-platform/4.3/applications/application-health.html)\n- [Virtual Machine Health](https://docs.openshift.com/container-platform/4.3/cnv/cnv_logging_events_monitoring/cnv-monitoring-vm-health.html)\n\n**IKS**\n- [Container Probes](https://kubernetes.io/docs/concepts/workloads/pods/pod-lifecycle/#container-probes)\n- [Configure Probes](https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-probes/)\n\n## References\n\n```yaml\napiVersion: v1\nkind: Pod\nmetadata:\n  name: my-pod\nspec:\n  containers:\n  - name: app\n    image: busybox\n    command: ['sh', '-c', \"echo Hello, Kubernetes! && sleep 3600\"]\n    livenessProbe:\n      exec:\n        command: ['echo','alive']\n```\n\n```yaml\napiVersion: v1\nkind: Pod\nmetadata:\n  name: my-pod\nspec:\n  shareProcessNamespace: true\n  containers:\n  - name: app\n    image: bitnami/nginx\n    ports:\n    - containerPort: 8080\n    livenessProbe:\n      tcpSocket:\n        port: 8080\n      initialDelaySeconds: 10\n    readinessProbe:\n      httpGet:\n        path: /\n        port: 8080\n      periodSeconds: 10\n```\n\n# Container Logging\n\nApplication and systems logs can help you understand what is happening inside your cluster. The logs are particularly useful for debugging problems and monitoring cluster activity.\n\nKubernetes provides no native storage solution for log data, but you can integrate many existing logging solutions into your Kubernetes cluster.\n\n## Resources\n\n**OpenShift**\n- [Logs Command](https://docs.openshift.com/container-platform/4.3/cli_reference/openshift_cli/developer-cli-commands.html#logs)\n- [Cluster Logging](https://docs.openshift.com/container-platform/4.3/logging/cluster-logging.html)\n- [Logging Collector](https://docs.openshift.com/container-platform/4.3/logging/config/cluster-logging-collector.html)\n\n**IKS**\n- [Logging](https://kubernetes.io/docs/concepts/cluster-administration/logging/)\n\n## References\n\n\n```yaml\napiVersion: v1\nkind: Pod\nmetadata:\n  name: counter\nspec:\n  containers:\n  - name: count\n    image: busybox\n    command: ['sh','-c','i=0; while true; do echo \"$i: $(date)\"; i=$((i+1)); sleep 5; done']\n```\n<Tabs>\n<Tab label=\"OpenShift\">\n\n** Get Logs **\n```\noc logs\n```\n** Use Stern to View Logs **\n```\nbrew install stern\nstern . -n default\n```\n\n</Tab>\n\n<Tab label=\"IKS\">\n\n** Get Logs **\n```\nkubectl logs\n```\n** Use Stern to View Logs **\n```\nbrew install stern\nstern . -n default\n```\n\n</Tab>\n\n</Tabs>\n\n# Monitoring Applications\n\nTo scale an application and provide a reliable service, you need to understand how the application behaves when it is deployed. You can examine application performance in a Kubernetes cluster by examining the containers, pods, services, and the characteristics of the overall cluster. Kubernetes provides detailed information about an application’s resource usage at each of these levels. This information allows you to evaluate your application’s performance and where bottlenecks can be removed to improve overall performance.\n\nPrometheus, a CNCF project, can natively monitor Kubernetes, nodes, and Prometheus itself.\n\n## Resources\n\n**OpenShift**\n- [Monitoring Application Health](https://docs.openshift.com/container-platform/4.3/applications/application-health.html)\n- [Monitoring Services](https://docs.openshift.com/container-platform/4.3/monitoring/monitoring-your-own-services.html)\n- [Custom Application Metrics](https://docs.openshift.com/container-platform/4.3/monitoring/exposing-custom-application-metrics-for-autoscaling.html)\n\n**IKS**\n- [Monitoring Resource Usage](https://kubernetes.io/docs/tasks/debug-application-cluster/resource-usage-monitoring/)\n- [Resource Metrics](https://kubernetes.io/docs/tasks/debug-application-cluster/resource-metrics-pipeline/)\n\n## References\n\n```yaml\napiVersion: v1\nkind: Pod\nmetadata:\n  name: 500m\nspec:\n  containers:\n  - name: app\n    image: gcr.io/kubernetes-e2e-test-images/resource-consumer:1.4\n    resources:\n      requests:\n        cpu: 700m\n        memory: 128Mi\n  - name: busybox-sidecar\n    image: radial/busyboxplus:curl\n    command: [/bin/sh, -c, 'until curl localhost:8080/ConsumeCPU -d \"millicores=500&durationSec=3600\"; do sleep 5; done && sleep 3700']\n```\n\n```yaml\napiVersion: v1\nkind: Pod\nmetadata:\n  name: 200m\nspec:\n  containers:\n  - name: app\n    image: gcr.io/kubernetes-e2e-test-images/resource-consumer:1.4\n    resources:\n      requests:\n        cpu: 300m\n        memory: 64Mi\n  - name: busybox-sidecar\n    image: radial/busyboxplus:curl\n    command: [/bin/sh, -c, 'until curl localhost:8080/ConsumeCPU -d \"millicores=200&durationSec=3600\"; do sleep 5; done && sleep 3700']\n```\n<Tabs>\n<Tab label=\"OpenShift\">\n\n```\n  oc get projects\n  oc api-resources -o wide\n  oc api-resources -o name\n\n  oc get nodes,ns,po,deploy,svc\n\n  oc describe node --all\n  ```\n\n</Tab>\n\n<Tab label=\"IKS\">\n\n** Verify Metrics is enabled**\n```\nkubectl get --raw /apis/metrics.k8s.io/\n```\n\n** Get Node Description **\n```\nkubectl describe node\n```\n\n** Check Resource Useage **\n```\nkubectl top pods\nkubectl top nodes\n```\n\n</Tab>\n\n</Tabs>\n\n## Activities\n\n| Task                            | Description         | Link        |\n| --------------------------------| ------------------  |:----------- |\n| *** Try It Yourself ***                         |         |         |\n| Probes | Create some Health & Startup Probes to find what's causing an issue.  | [Probes](../kube-overview/activities/labs/lab4) |\n","type":"Mdx","contentDigest":"4cb273b484f64a86688da2928327b2bd","counter":568,"owner":"gatsby-plugin-mdx"},"exports":[],"rawBody":"---\ntitle: Observability\ndescription:  Observability in Kubernetes\n---\n\n<AnchorLinks small>\n  <AnchorLink>Liveness and Readiness Probes</AnchorLink>\n  <AnchorLink>Container Logging</AnchorLink>\n  <AnchorLink>Monitoring Applications</AnchorLink>\n  <AnchorLink>Activities</AnchorLink>\n</AnchorLinks>\n\n# Liveness and Readiness Probes\n\nA Probe is a diagnostic performed periodically by the kubelet on a Container. To perform a diagnostic, the kubelet calls a Handler implemented by the Container. There are three types of handlers:\n\n***ExecAction***: Executes a specified command inside the Container. The diagnostic is considered successful if the command exits with a status code of 0.\n\n***TCPSocketAction***: Performs a TCP check against the Container’s IP address on a specified port. The diagnostic is considered successful if the port is open.\n\n***HTTPGetAction***: Performs an HTTP Get request against the Container’s IP address on a specified port and path. The diagnostic is considered successful if the response has a status code greater than or equal to 200 and less than 400.\n\nThe kubelet can optionally perform and react to three kinds of probes on running Containers:\n\n***livenessProbe***: Indicates whether the Container is running. Runs for the lifetime of the Container.\n\n***readinessProbe***: Indicates whether the Container is ready to service requests. Only runs at start.\n\n\n## Resources\n\n**OpenShift**\n- [Application Health](https://docs.openshift.com/container-platform/4.3/applications/application-health.html)\n- [Virtual Machine Health](https://docs.openshift.com/container-platform/4.3/cnv/cnv_logging_events_monitoring/cnv-monitoring-vm-health.html)\n\n**IKS**\n- [Container Probes](https://kubernetes.io/docs/concepts/workloads/pods/pod-lifecycle/#container-probes)\n- [Configure Probes](https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-probes/)\n\n## References\n\n```yaml\napiVersion: v1\nkind: Pod\nmetadata:\n  name: my-pod\nspec:\n  containers:\n  - name: app\n    image: busybox\n    command: ['sh', '-c', \"echo Hello, Kubernetes! && sleep 3600\"]\n    livenessProbe:\n      exec:\n        command: ['echo','alive']\n```\n\n```yaml\napiVersion: v1\nkind: Pod\nmetadata:\n  name: my-pod\nspec:\n  shareProcessNamespace: true\n  containers:\n  - name: app\n    image: bitnami/nginx\n    ports:\n    - containerPort: 8080\n    livenessProbe:\n      tcpSocket:\n        port: 8080\n      initialDelaySeconds: 10\n    readinessProbe:\n      httpGet:\n        path: /\n        port: 8080\n      periodSeconds: 10\n```\n\n# Container Logging\n\nApplication and systems logs can help you understand what is happening inside your cluster. The logs are particularly useful for debugging problems and monitoring cluster activity.\n\nKubernetes provides no native storage solution for log data, but you can integrate many existing logging solutions into your Kubernetes cluster.\n\n## Resources\n\n**OpenShift**\n- [Logs Command](https://docs.openshift.com/container-platform/4.3/cli_reference/openshift_cli/developer-cli-commands.html#logs)\n- [Cluster Logging](https://docs.openshift.com/container-platform/4.3/logging/cluster-logging.html)\n- [Logging Collector](https://docs.openshift.com/container-platform/4.3/logging/config/cluster-logging-collector.html)\n\n**IKS**\n- [Logging](https://kubernetes.io/docs/concepts/cluster-administration/logging/)\n\n## References\n\n\n```yaml\napiVersion: v1\nkind: Pod\nmetadata:\n  name: counter\nspec:\n  containers:\n  - name: count\n    image: busybox\n    command: ['sh','-c','i=0; while true; do echo \"$i: $(date)\"; i=$((i+1)); sleep 5; done']\n```\n<Tabs>\n<Tab label=\"OpenShift\">\n\n** Get Logs **\n```\noc logs\n```\n** Use Stern to View Logs **\n```\nbrew install stern\nstern . -n default\n```\n\n</Tab>\n\n<Tab label=\"IKS\">\n\n** Get Logs **\n```\nkubectl logs\n```\n** Use Stern to View Logs **\n```\nbrew install stern\nstern . -n default\n```\n\n</Tab>\n\n</Tabs>\n\n# Monitoring Applications\n\nTo scale an application and provide a reliable service, you need to understand how the application behaves when it is deployed. You can examine application performance in a Kubernetes cluster by examining the containers, pods, services, and the characteristics of the overall cluster. Kubernetes provides detailed information about an application’s resource usage at each of these levels. This information allows you to evaluate your application’s performance and where bottlenecks can be removed to improve overall performance.\n\nPrometheus, a CNCF project, can natively monitor Kubernetes, nodes, and Prometheus itself.\n\n## Resources\n\n**OpenShift**\n- [Monitoring Application Health](https://docs.openshift.com/container-platform/4.3/applications/application-health.html)\n- [Monitoring Services](https://docs.openshift.com/container-platform/4.3/monitoring/monitoring-your-own-services.html)\n- [Custom Application Metrics](https://docs.openshift.com/container-platform/4.3/monitoring/exposing-custom-application-metrics-for-autoscaling.html)\n\n**IKS**\n- [Monitoring Resource Usage](https://kubernetes.io/docs/tasks/debug-application-cluster/resource-usage-monitoring/)\n- [Resource Metrics](https://kubernetes.io/docs/tasks/debug-application-cluster/resource-metrics-pipeline/)\n\n## References\n\n```yaml\napiVersion: v1\nkind: Pod\nmetadata:\n  name: 500m\nspec:\n  containers:\n  - name: app\n    image: gcr.io/kubernetes-e2e-test-images/resource-consumer:1.4\n    resources:\n      requests:\n        cpu: 700m\n        memory: 128Mi\n  - name: busybox-sidecar\n    image: radial/busyboxplus:curl\n    command: [/bin/sh, -c, 'until curl localhost:8080/ConsumeCPU -d \"millicores=500&durationSec=3600\"; do sleep 5; done && sleep 3700']\n```\n\n```yaml\napiVersion: v1\nkind: Pod\nmetadata:\n  name: 200m\nspec:\n  containers:\n  - name: app\n    image: gcr.io/kubernetes-e2e-test-images/resource-consumer:1.4\n    resources:\n      requests:\n        cpu: 300m\n        memory: 64Mi\n  - name: busybox-sidecar\n    image: radial/busyboxplus:curl\n    command: [/bin/sh, -c, 'until curl localhost:8080/ConsumeCPU -d \"millicores=200&durationSec=3600\"; do sleep 5; done && sleep 3700']\n```\n<Tabs>\n<Tab label=\"OpenShift\">\n\n```\n  oc get projects\n  oc api-resources -o wide\n  oc api-resources -o name\n\n  oc get nodes,ns,po,deploy,svc\n\n  oc describe node --all\n  ```\n\n</Tab>\n\n<Tab label=\"IKS\">\n\n** Verify Metrics is enabled**\n```\nkubectl get --raw /apis/metrics.k8s.io/\n```\n\n** Get Node Description **\n```\nkubectl describe node\n```\n\n** Check Resource Useage **\n```\nkubectl top pods\nkubectl top nodes\n```\n\n</Tab>\n\n</Tabs>\n\n## Activities\n\n| Task                            | Description         | Link        |\n| --------------------------------| ------------------  |:----------- |\n| *** Try It Yourself ***                         |         |         |\n| Probes | Create some Health & Startup Probes to find what's causing an issue.  | [Probes](../kube-overview/activities/labs/lab4) |\n","frontmatter":{"title":"Observability","description":"Observability in Kubernetes"},"fileAbsolutePath":"/home/travis/build/ibm-cloud-architecture/learning-cloudnative-101/src/pages/lectures/kube-observability/index.mdx"}}},"staticQueryHashes":["1364590287","2102389209","2102389209","2456312558","2746626797","2746626797","3018647132","3018647132","3037994772","3037994772","63531786","63531786","768070550"]}