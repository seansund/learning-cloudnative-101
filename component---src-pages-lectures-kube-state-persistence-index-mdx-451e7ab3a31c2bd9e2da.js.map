{"version":3,"sources":["webpack:///./src/pages/lectures/kube-state-persistence/index.mdx"],"names":["_frontmatter","makeShortcode","name","props","console","warn","AnchorLinks","AnchorLink","Tabs","Tab","layoutProps","MDXLayout","DefaultLayout","MDXContent","components","mdxType","small","parentName","label","isMDXComponent"],"mappings":"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","file":"component---src-pages-lectures-kube-state-persistence-index-mdx-451e7ab3a31c2bd9e2da.js","sourcesContent":["import * as React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsx mdx */\n\nimport DefaultLayout from \"/home/travis/build/ibm-cloud-architecture/learning-cloudnative-101/node_modules/gatsby-theme-carbon/src/templates/Default.js\";\nexport const _frontmatter = {};\n\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n  return <div {...props} />;\n};\n\nconst AnchorLinks = makeShortcode(\"AnchorLinks\");\nconst AnchorLink = makeShortcode(\"AnchorLink\");\nconst Tabs = makeShortcode(\"Tabs\");\nconst Tab = makeShortcode(\"Tab\");\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <AnchorLinks small mdxType=\"AnchorLinks\">\n  <AnchorLink mdxType=\"AnchorLink\">Volumes</AnchorLink>\n  <AnchorLink mdxType=\"AnchorLink\">PersistentVolumes and PersistentVolumeClaims</AnchorLink>\n  <AnchorLink mdxType=\"AnchorLink\">Activities</AnchorLink>\n    </AnchorLinks>\n    <h1>{`Volumes`}</h1>\n    <p>{`On-disk files in a Container are ephemeral, which presents some problems for non-trivial applications when running in Containers. First, when a Container crashes, kubelet will restart it, but the files will be lost - the Container starts with a clean state. Second, when running Containers together in a Pod it is often necessary to share files between those Containers. The Kubernetes Volume abstraction solves both of these problems.`}</p>\n    <p>{`Docker also has a concept of volumes, though it is somewhat looser and less managed. In Docker, a volume is simply a directory on disk or in another Container.`}</p>\n    <p>{`A Kubernetes volume, on the other hand, has an explicit lifetime - the same as the Pod that encloses it. Consequently, a volume outlives any Containers that run within the Pod, and data is preserved across Container restarts. Of course, when a Pod ceases to exist, the volume will cease to exist, too. Perhaps more importantly than this, Kubernetes supports many types of volumes, and a Pod can use any number of them simultaneously.`}</p>\n    <h2>{`Resources`}</h2>\n    <p><strong parentName=\"p\">{`OpenShift`}</strong></p>\n    <ul>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"https://docs.openshift.com/container-platform/4.3/storage/understanding-persistent-storage.html#lifecycle-volume-claim_understanding-persistent-storage\"\n        }}>{`Volume Lifecycle`}</a></li>\n    </ul>\n    <p><strong parentName=\"p\">{`IKS`}</strong></p>\n    <ul>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"https://kubernetes.io/docs/concepts/storage/volumes/\"\n        }}>{`Volumes`}</a></li>\n    </ul>\n    <h2>{`References`}</h2>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-yaml\"\n      }}>{`apiVersion: v1\nkind: Pod\nmetadata:\n  name: my-pod\nspec:\n  containers:\n  - image: busybox\n    command: ['sh', '-c', 'echo Hello Kubernetes! && sleep 3600']\n    name: busybox\n    volumeMounts:\n    - mountPath: /cache\n      name: cache-volume\n  volumes:\n  - name: cache-volume\n    emptyDir: {}\n`}</code></pre>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-yaml\"\n      }}>{`apiVersion: v1\nkind: Pod\nmetadata:\n  name: test-pd\nspec:\n  containers:\n  - image: bitnami/nginx\n    name: test-container\n    volumeMounts:\n    - mountPath: /test-pd\n      name: test-volume\n  volumes:\n  - name: test-volume\n    hostPath:\n      # directory location on host\n      path: /data\n      # this field is optional\n      type: Directory\n`}</code></pre>\n    <h1>{`PersistentVolumes and PersistentVolumeClaims`}</h1>\n    <p>{`Managing storage is a distinct problem from managing compute instances. The PersistentVolume subsystem provides an API for users and administrators that abstracts details of how storage is provided from how it is consumed.`}</p>\n    <p>{`A PersistentVolume (PV) is a piece of storage in the cluster that has been provisioned by an administrator or dynamically provisioned using Storage Classes.`}</p>\n    <p>{`A PersistentVolumeClaim (PVC) is a request for storage by a user. It is similar to a Pod. Pods consume node resources and PVCs consume PV resources. Claims can request specific size and access modes (e.g., they can be mounted once read/write or many times read-only).`}</p>\n    <p>{`While PersistentVolumeClaims allow a user to consume abstract storage resources, it is common that users need PersistentVolumes with varying properties, such as performance, for different problems. Cluster administrators need to be able to offer a variety of PersistentVolumes that differ in more ways than just size and access modes, without exposing users to the details of how those volumes are implemented. For these needs, there is the StorageClass resource.`}</p>\n    <p>{`Pods access storage by using the claim as a volume. Claims must exist in the same namespace as the Pod using the claim. The cluster finds the claim in the Pod’s namespace and uses it to get the PersistentVolume backing the claim. The volume is then mounted to the host and into the Pod.`}</p>\n    <p>{`PersistentVolumes binds are exclusive, and since PersistentVolumeClaims are namespaced objects, mounting claims with “Many” modes (ROX, RWX) is only possible within one namespace.`}</p>\n    <h2>{`Resources`}</h2>\n    <p><strong parentName=\"p\">{`OpenShift`}</strong></p>\n    <ul>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"https://docs.openshift.com/container-platform/4.3/storage/understanding-persistent-storage.html\"\n        }}>{`Persistent Storage`}</a></li>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"https://docs.openshift.com/container-platform/4.3/storage/understanding-persistent-storage.html#types-of-persistent-volumes_understanding-persistent-storage\"\n        }}>{`Persistent Volume Types`}</a></li>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"https://docs.openshift.com/container-platform/4.3/storage/expanding-persistent-volumes.html\"\n        }}>{`Expanding Peristent Volumes`}</a></li>\n    </ul>\n    <p><strong parentName=\"p\">{`IKS`}</strong></p>\n    <ul>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"https://kubernetes.io/docs/concepts/storage/persistent-volumes/\"\n        }}>{`Persistent Volumes`}</a></li>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"https://kubernetes.io/docs/concepts/storage/persistent-volumes/#writing-portable-configuration\"\n        }}>{`Writing Portable Configurations`}</a></li>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"https://kubernetes.io/docs/tasks/configure-pod-container/configure-persistent-volume-storage/\"\n        }}>{`Configuring Persistent Volume Storage`}</a></li>\n    </ul>\n    <h2>{`References`}</h2>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-yaml\"\n      }}>{`kind: PersistentVolume\napiVersion: v1\nmetadata:\n  name: my-pv\nspec:\n  storageClassName: local-storage\n  capacity:\n    storage: 128Mi\n  accessModes:\n    - ReadWriteOnce\n  hostPath:\n    path: \"/mnt/data-1\"\n`}</code></pre>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-yaml\"\n      }}>{`apiVersion: v1\nkind: PersistentVolumeClaim\nmetadata:\n  name: my-pvc\nspec:\n  storageClassName: local-storage\n  accessModes:\n    - ReadWriteOnce\n  resources:\n    requests:\n      storage: 100Mi\n`}</code></pre>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-yaml\"\n      }}>{`kind: Pod\napiVersion: v1\nmetadata:\n  name: my-pod\nspec:\n  containers:\n  - name: nginx\n    image: busybox\n    command: ['sh', '-c', 'echo $(date):$HOSTNAME Hello Kubernetes! >> /mnt/data/message.txt && sleep 3600']\n    volumeMounts:\n    - mountPath: \"/mnt/data\"\n      name: my-data\n  volumes:\n  - name: my-data\n    persistentVolumeClaim:\n      claimName: my-pvc\n`}</code></pre>\n    <Tabs mdxType=\"Tabs\">\n  <Tab label=\"OpenShift\" mdxType=\"Tab\">\n        <p>{`  `}<strong parentName=\"p\">{`Getting the Persistent Volumes in Project`}</strong>{` `}</p>\n        <pre><code parentName=\"pre\" {...{}}>{`  oc get pv \n`}</code></pre>\n        <p>{`  `}<strong parentName=\"p\">{`Getting the Persistent Volume Claims `}</strong>{` `}</p>\n        <pre><code parentName=\"pre\" {...{}}>{`  oc get pvc\n`}</code></pre>\n        <p>{`  `}<strong parentName=\"p\">{`Getting a specific Persistent Volume`}</strong>{` `}</p>\n        <pre><code parentName=\"pre\" {...{}}>{`  oc get pv <pv-claim>\n`}</code></pre>\n  </Tab>\n  <Tab label=\"IKS\" mdxType=\"Tab\">\n        <p>{`  `}<strong parentName=\"p\">{`Getting the PersistentVolume `}</strong>{` `}</p>\n        <pre><code parentName=\"pre\" {...{}}>{`  kubectl get pv\n`}</code></pre>\n        <p>{`  `}<strong parentName=\"p\">{`Getting the PersistentVolumeClaims `}</strong>{` `}</p>\n        <pre><code parentName=\"pre\" {...{}}>{`  kubectl get pvc\n`}</code></pre>\n  </Tab>\n    </Tabs>\n    <h2>{`Activities`}</h2>\n    <table>\n      <thead parentName=\"table\">\n        <tr parentName=\"thead\">\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Task`}</th>\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Description`}</th>\n          <th parentName=\"tr\" {...{\n            \"align\": \"left\"\n          }}>{`Link`}</th>\n        </tr>\n      </thead>\n      <tbody parentName=\"table\">\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><strong parentName=\"td\"><em parentName=\"strong\">{` Try It Yourself `}</em></strong></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}></td>\n          <td parentName=\"tr\" {...{\n            \"align\": \"left\"\n          }}></td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Setting up Persistent Volumes`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Create a Persistent Volume that’s accessible from a SQL Pod.`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": \"left\"\n          }}><a parentName=\"td\" {...{\n              \"href\": \"../kube-overview/activities/labs/lab10\"\n            }}>{`Setting up Persistent Volumes`}</a></td>\n        </tr>\n      </tbody>\n    </table>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      "],"sourceRoot":""}